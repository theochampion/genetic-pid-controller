{"version":3,"sources":["simulator/pid_controller.js","simulator/vehicle.js","simulator/scene.js","simulator/simulator_engine.js","genetic/selectors.js","genetic/genetic.js","utils/string.js","utils/math.js","genetic/genetic_config.js","simulator/simulator_renderer.js","components/logo.js","components/stat_line.js","components/overlay.js","components/settings_panel.js","components/setting_input.js","components/divider.js","components/button.js","components/author.js","components/vis_panel.js","components/genome_vis.js","components/evol_perc_vis.js","components/stat_plot.js","utils/misc.js","App.js","serviceWorker.js","index.js"],"names":["PIDController","k_p","k_i","k_d","dt","Object","classCallCheck","this","i_max","sumError","lastError","lastTime","target","currentValue","currentTime","Date","now","error","Math","abs","sumSign","dError","vehicle","xx","yy","width","height","wheelYOffset","body","Bodies","rectangle","collisionFilter","group","chamfer","radius","density","label","wheel","circle","friction","axelA","Constraint","create","bodyB","pointB","x","y","bodyA","stiffness","length","composite","Composite","addBody","addConstraint","collidableBodyId","id","correctionFactor","Body","setAngularVelocity","angle","Scene","wallOptions","isSensor","isStatic","rightWall","leftWall","topWall","bottomWall","render","visible","rotationStep","rotationFactor","walls","add","spike2","polygon","spike3","spike4","allBodies","forEach","setAngle","PI","ts","_this","rotate","SimulatorEngine","vehicles","engine","Engine","simulationWidth","window","innerWidth","simulationHeight","innerHeight","Events","on","event","pairs","pair","item","index","object","obj","resolver","stepCount","splice","scene","rotateRandomly","setWheelAngularVelocity","controller","update","getBodyAngle","World","world","run","reset","p","i","d","vehicleObj","Vehicle","setTarget","resPromise","Promise","resolve","reject","promiseResolver","push","remove","filter","_this2","individualSelectors","tournament2","population","optimizer","n","a","floor","random","b","fitness","genome","tournament3","c","best","fittest","parentsSelectors","fittestRandom","optimizers","maximize","minimize","defaultConfig","iterations","population_size","mutation_rate","crossover_rate","fittestAlwaysSurvive","Genetic","newIndividualFromGenome","shouldApplyFromRate","rate","stopFlag","seed","mutate","crossover","optimize","generation","notification","selectParents","selectIndividual","config","objectSpread","gen","map","_ref","asyncToGenerator","regenerator_default","mark","_callee","individual","wrap","_context","prev","next","t0","sent","t1","abrupt","stop","_x2","apply","arguments","preFitnessEval","all","sort","newPopulation","parents","childrens","concat","children","indiv","decodeFloatsFromBinaryStr","binStr","floatNb","number","in_min","in_max","out_min","paramBitLength","decoded","parseInt","substr","Number","MAX_SAFE_INTEGER","bitLength","toString","PIDParams","PIDParam","str","repeat","entity","string","replace","flipIndex","substring","mother","father","len","ca","cb","tmp","Canvas","styled","canvas","_templateObject","SimulatorRenderer","props","possibleConstructorReturn","getPrototypeOf","call","canvasRef","React","createRef","current","addEventListener","Render","options","wireframes","showAngleIndicator","showCollisions","showIds","showDebug","mouse","Mouse","mouseConstraint","MouseConstraint","constraint","react_default","createElement","ref","Component","LogoWrapper","div","logo_templateObject","LogoText","_templateObject2","Logo","StatLine","stat_line_templateObject","Overlay","overlay_templateObject","SettingsPanel","settings_panel_templateObject","SettingInputLineWrapper","setting_input_templateObject","SettingName","setting_input_templateObject2","SettingInput","input","_templateObject3","SettingSelect","select","_templateObject4","SettingSelectOption","option","_templateObject5","SettingInputLine","text","name","value","disabled","onChange","undefined","key","Divider","divider_templateObject","Button","button","button_templateObject","AuthorWrapper","author_templateObject","AuthorLink","author_templateObject2","Author","role","aria-label","href","VisPanel","vis_panel_templateObject","GenVisContainer","genome_vis_templateObject","GenBitChange","span","genome_vis_templateObject2","GenomeVis","exGenome","Array","from","bit","idx","NegPerc","evol_perc_vis_templateObject","EvolPercVis","perc","toFixed","StatPlotContainer","stat_plot_templateObject","StatPlot","best_fitness_data","avg_fitness_data","es","data","color","curve","opacity","strokeStyle","strokeWidth","title","style","line","stroke","ticks","fill","fontWeight","getLastItem","arr","getFitnessStatPercIncrease","statsToCSVFile","avg","csv","console","log","encodeURI","settings","default_seed","App","_runSimulation","seedrandom","state","random_seed","global","geneticEngine","parseFloat","setState","simulationRunning","_stopSimulation","simulatorEngine","_handleSettingChange","e","defineProperty","_downloadStatsAsCSV","encodedCSV","best_fitness_stat","avg_fitness_stat","exportName","indiv_selector","parent_selector","link","document","setAttribute","appendChild","click","removeChild","ex_fittest_genome","fittest_genome","fittest_params","pv","toConsumableArray","reduce","pidParams","addVehicle","_x","Fragment","overlay","settings_panel","logo","author","divider","setting_input","keys","_ref2","components_button","onClick","vis_panel","stat_line","evol_perc_vis","stat_plot","genome_vis","simulator_renderer_SimulatorRenderer","Boolean","location","hostname","match","ReactDOM","App_App","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.f50f03af.chunk.js","sourcesContent":["export default class PIDController {\n\tconstructor(k_p, k_i, k_d, dt) {\n\t\tlet i_max;\n\n\t\t// PID constants\n\t\tthis.k_p = typeof k_p === \"number\" ? k_p : 1;\n\t\tthis.k_i = k_i || 0;\n\t\tthis.k_d = k_d || 0;\n\n\t\t// Interval of time between two updates\n\t\t// If not set, it will be automatically calculated\n\t\tthis.dt = dt || 0;\n\n\t\t// Maximum absolute value of sumError\n\t\tthis.i_max = i_max || 0;\n\n\t\tthis.sumError = 0;\n\t\tthis.lastError = 0;\n\t\tthis.lastTime = 0;\n\n\t\tthis.target = 0; // default value, can be modified with .setTarget\n\t}\n\n\tsetTarget(target) {\n\t\tthis.target = target;\n\t}\n\n\tupdate(currentValue) {\n\t\tthis.currentValue = currentValue;\n\n\t\t// Calculate dt\n\t\tlet dt = this.dt;\n\t\tif (!dt) {\n\t\t\tlet currentTime = Date.now();\n\t\t\tif (this.lastTime === 0) {\n\t\t\t\t// First time update() is called\n\t\t\t\tdt = 0;\n\t\t\t} else {\n\t\t\t\tdt = (currentTime - this.lastTime) / 1000; // in seconds\n\t\t\t}\n\t\t\tthis.lastTime = currentTime;\n\t\t}\n\t\tif (typeof dt !== \"number\" || dt === 0) {\n\t\t\tdt = 1;\n\t\t}\n\n\t\tlet error = this.target - this.currentValue;\n\t\tthis.sumError = this.sumError + error * dt;\n\t\tif (this.i_max > 0 && Math.abs(this.sumError) > this.i_max) {\n\t\t\tlet sumSign = this.sumError > 0 ? 1 : -1;\n\t\t\tthis.sumError = sumSign * this.i_max;\n\t\t}\n\n\t\tlet dError = (error - this.lastError) / dt;\n\t\tthis.lastError = error;\n\n\t\treturn this.k_p * error + this.k_i * this.sumError + this.k_d * dError;\n\t}\n\n\treset() {\n\t\tthis.sumError = 0;\n\t\tthis.lastError = 0;\n\t\tthis.lastTime = 0;\n\t}\n}\n","import { Body, Bodies, Composite, Constraint } from \"matter-js\";\n\n/**\n * Creates a composite with simple vehicle setup of bodies and constraints.\n * @method vehicle\n * @param {number} xx\n * @param {number} yy\n * @param {number} width\n * @param {number} height\n * @return {composite} A new composite vehicle body\n */\nexport default class vehicle {\n\tconstructor(xx, yy, width, height) {\n\t\tconst wheelToBodyRatio = 2.3;\n\t\tconst wheelXOffset = 0;\n\t\tconst wheelYOffset = height / 2;\n\n\t\tthis.body = Bodies.rectangle(\n\t\t\txx,\n\t\t\tyy - width / wheelToBodyRatio,\n\t\t\twidth,\n\t\t\theight,\n\t\t\t{\n\t\t\t\tcollisionFilter: {\n\t\t\t\t\tgroup: -1\n\t\t\t\t},\n\t\t\t\tchamfer: {\n\t\t\t\t\tradius: 10\n\t\t\t\t},\n\t\t\t\tdensity: 0.0002,\n\t\t\t\tlabel: \"vehicle_body\"\n\t\t\t}\n\t\t);\n\n\t\tthis.wheel = Bodies.circle(\n\t\t\txx + wheelXOffset,\n\t\t\tyy + wheelYOffset,\n\t\t\twidth / wheelToBodyRatio,\n\t\t\t{\n\t\t\t\tcollisionFilter: {\n\t\t\t\t\tgroup: -1\n\t\t\t\t},\n\t\t\t\tfriction: 0.8,\n\t\t\t\tlabel: \"vehicle_wheel\"\n\t\t\t}\n\t\t);\n\n\t\tconst axelA = Constraint.create({\n\t\t\tbodyB: this.body,\n\t\t\tpointB: { x: wheelXOffset, y: wheelYOffset },\n\t\t\tbodyA: this.wheel,\n\t\t\tstiffness: 1,\n\t\t\tlength: 0\n\t\t});\n\n\t\tthis.composite = Composite.create({\n\t\t\tlabel: \"vehicle\"\n\t\t});\n\t\tComposite.addBody(this.composite, this.body);\n\t\tComposite.addBody(this.composite, this.wheel);\n\t\tComposite.addConstraint(this.composite, axelA);\n\t\tthis.collidableBodyId = this.body.id;\n\t}\n\n\tsetWheelAngularVelocity(correctionFactor) {\n\t\tBody.setAngularVelocity(this.wheel, -correctionFactor);\n\t}\n\n\tgetBodyAngle() {\n\t\treturn this.body.angle;\n\t}\n}\n","import { Composite, Body, Bodies } from \"matter-js\";\n\nexport default class Scene {\n\tconstructor(width, height) {\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\tconst wallOptions = {\n\t\t\tisSensor: true,\n\t\t\tisStatic: true\n\t\t};\n\t\tconst rightWall = Bodies.rectangle(\n\t\t\twidth / 2 + height / 2,\n\t\t\theight / 2,\n\t\t\t1,\n\t\t\theight,\n\t\t\twallOptions\n\t\t);\n\t\tconst leftWall = Bodies.rectangle(\n\t\t\twidth / 2 - height / 2,\n\t\t\theight / 2,\n\t\t\t1,\n\t\t\theight,\n\t\t\twallOptions\n\t\t);\n\t\tconst topWall = Bodies.rectangle(width / 2, 0, height, 1, wallOptions);\n\t\tconst bottomWall = Bodies.rectangle(\n\t\t\twidth / 2,\n\t\t\theight,\n\t\t\theight,\n\t\t\t1,\n\t\t\twallOptions\n\t\t);\n\t\trightWall.render.visible = false;\n\t\tleftWall.render.visible = false;\n\t\ttopWall.render.visible = false;\n\t\tbottomWall.render.visible = false;\n\n\t\tthis.rotationStep = 0.0;\n\t\tthis.rotationFactor = 0.000015;\n\n\t\tthis.walls = Composite.create({ label: \"walls\" });\n\t\tComposite.add(this.walls, [leftWall, rightWall, topWall, bottomWall]);\n\n\t\tthis.wheel = Composite.create({ label: \"wheel\" });\n\n\t\tthis.spike2 = Bodies.polygon(width / 2, height * 1.7, 4, height, {\n\t\t\tisStatic: true,\n\t\t\tfriction: 0.8,\n\t\t\tchamfer: { radius: 70 }\n\t\t});\n\t\tthis.spike3 = Bodies.polygon(width / 2, height * 1.7, 6, height, {\n\t\t\tisStatic: true,\n\t\t\tfriction: 0.8,\n\t\t\tchamfer: { radius: 70 }\n\t\t});\n\t\tthis.spike4 = Bodies.polygon(width / 2, height * 1.7, 7, height, {\n\t\t\tisStatic: true,\n\t\t\tfriction: 0.8,\n\t\t\tchamfer: { radius: 100 }\n\t\t});\n\t\t//Body.setAngle(this.mainWheel, -Math.PI / 2);\n\t\tComposite.add(this.wheel, [\n\t\t\t// this.mainWheel,\n\t\t\t// this.spike,\n\t\t\tthis.spike2,\n\t\t\tthis.spike3,\n\t\t\tthis.spike4\n\t\t]);\n\t\tthis.composite = Composite.create({ label: \"scene\" });\n\t\tComposite.add(this.composite, [this.walls, this.wheel]);\n\t}\n\n\treset() {\n\t\tComposite.allBodies(this.wheel).forEach(body => {\n\t\t\tBody.setAngle(body, -Math.PI / 2);\n\t\t});\n\t\tthis.rotationStep = 0.0;\n\t\tthis.rotationFactor = 0.000015;\n\t}\n\trotateRandomly(ts) {\n\t\t//const stepSpeed = bezier(this.rotationFactor, 0.41, 0.01, 0.14, 0.98) / 100; //this.rotationFactor;\n\t\tthis.rotationStep += this.rotationFactor;\n\t\t//console.log(this.rotationFactor);\n\t\t//console.log(bezier(this.rotationFactor, 0.25, 0.46, 0.45, 0.94));\n\t\tComposite.allBodies(this.wheel).forEach(body => {\n\t\t\tBody.rotate(body, this.rotationStep);\n\t\t\tBody.setAngularVelocity(body, this.rotationStep);\n\t\t});\n\t\tif (this.rotationFactor > 0.00000001) this.rotationFactor -= 0.00000001;\n\t}\n}\n","import { Engine, Events, World, Composite } from \"matter-js\";\nimport PIDController from \"./pid_controller\";\n\n// objects\nimport Vehicle from \"./vehicle\";\nimport Scene from \"./scene\";\n\nexport default class SimulatorEngine {\n\tconstructor() {\n\t\tthis.vehicles = [];\n\t\tthis.engine = Engine.create();\n\t\tthis.simulationWidth = window.innerWidth;\n\t\tthis.simulationHeight = window.innerHeight;\n\n\t\tEvents.on(this.engine, \"collisionStart\", event => {\n\t\t\tevent.pairs.forEach(pair => {\n\t\t\t\tthis.vehicles.forEach((item, index, object) => {\n\t\t\t\t\tif (\n\t\t\t\t\t\tpair.bodyA.id === item.obj.collidableBodyId ||\n\t\t\t\t\t\tpair.bodyB.id === item.obj.collidableBodyId\n\t\t\t\t\t) {\n\t\t\t\t\t\titem.resolver(item.stepCount);\n\t\t\t\t\t\tobject.splice(index, 1);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\tEvents.on(this.engine, \"beforeUpdate\", event => {\n\t\t\tthis.scene.rotateRandomly();\n\t\t\tthis.vehicles.forEach(vehicle => {\n\t\t\t\tvehicle.stepCount += 1;\n\t\t\t\tvehicle.obj.setWheelAngularVelocity(\n\t\t\t\t\tvehicle.controller.update(vehicle.obj.getBodyAngle())\n\t\t\t\t);\n\t\t\t});\n\t\t});\n\n\t\tthis.scene = new Scene(this.simulationWidth, this.simulationHeight);\n\t\tWorld.add(this.engine.world, [this.scene.composite]);\n\t\tEngine.run(this.engine);\n\t}\n\n\treset() {\n\t\tthis.scene.reset();\n\t}\n\n\tstop() {\n\t\t// resolve all running vehicles\n\t\tthis.vehicles.forEach(vehicle => vehicle.resolver(vehicle.stepCount));\n\t}\n\n\tasync addVehicle(p, i, d) {\n\t\tconst vehicleObj = new Vehicle(\n\t\t\tthis.simulationWidth / 2,\n\t\t\tthis.simulationHeight / 2,\n\t\t\tthis.simulationHeight / 5,\n\t\t\tthis.simulationHeight / 3\n\t\t);\n\t\tconst controller = new PIDController(p, i, d, 1);\n\t\tcontroller.setTarget(0);\n\t\tlet promiseResolver;\n\t\tvar resPromise = new Promise(function(resolve, reject) {\n\t\t\tpromiseResolver = resolve;\n\t\t});\n\t\tconst vehicle = {\n\t\t\tobj: vehicleObj,\n\t\t\tcontroller: controller,\n\t\t\tresolver: promiseResolver,\n\t\t\tstepCount: 0\n\t\t};\n\t\tthis.vehicles.push(vehicle);\n\n\t\tconst stepCount = await resPromise;\n\t\tComposite.remove(this.engine.world, vehicle.obj.composite);\n\t\tthis.vehicles = this.vehicles.filter(item => item !== vehicle);\n\t\treturn stepCount;\n\t}\n\n\trun() {\n\t\tthis.scene.reset();\n\t\tthis.vehicles.forEach(vehicle => {\n\t\t\tWorld.add(this.engine.world, [vehicle.obj.composite]);\n\t\t});\n\t}\n}\n","export const individualSelectors = {\n\ttournament2: (population, optimizer) => {\n\t\tvar n = population.length;\n\t\tvar a = population[Math.floor(Math.random() * n)];\n\t\tvar b = population[Math.floor(Math.random() * n)];\n\t\treturn optimizer(a.fitness, b.fitness) ? a.genome : b.genome;\n\t},\n\ttournament3: (population, optimizer) => {\n\t\tvar n = population.length;\n\t\tvar a = population[Math.floor(Math.random() * n)];\n\t\tvar b = population[Math.floor(Math.random() * n)];\n\t\tvar c = population[Math.floor(Math.random() * n)];\n\t\tvar best = optimizer(a.fitness, b.fitness) ? a : b;\n\t\tbest = optimizer(best.fitness, c.fitness) ? best : c;\n\t\treturn best.genome;\n\t},\n\tfittest: (population, optimizer) => population[0].genome,\n\trandom: (population, optimizer) =>\n\t\tpopulation[Math.floor(Math.random() * population.length)].genome\n};\n\nexport const parentsSelectors = {\n\ttournament2: (population, optimizer) => [\n\t\tindividualSelectors.tournament2(population, optimizer),\n\t\tindividualSelectors.tournament2(population, optimizer)\n\t],\n\ttournament3: (population, optimizer) => [\n\t\tindividualSelectors.tournament3(population, optimizer),\n\t\tindividualSelectors.tournament3(population, optimizer)\n\t],\n\trandom: population => [\n\t\tindividualSelectors.random(population),\n\t\tindividualSelectors.random(population)\n\t],\n\tfittestRandom: population => [\n\t\tindividualSelectors.fittest(population),\n\t\tindividualSelectors.random(population)\n\t]\n};\n","import { individualSelectors, parentsSelectors } from \"./selectors\";\n\nexport const optimizers = {\n\tmaximize: (a, b) => a >= b,\n\tminimize: (a, b) => a < b\n};\n\nconst defaultConfig = {\n\titerations: 5000,\n\tpopulation_size: 10,\n\tmutation_rate: 0.6,\n\tcrossover_rate: 0.6,\n\tfittestAlwaysSurvive: true\n};\nexport default class Genetic {\n\tconstructor() {\n\t\t// internals\n\t\tthis.population = [];\n\t\tthis.stopFlag = false;\n\n\t\t// population functions\n\t\tthis.fitness = null;\n\t\tthis.seed = null;\n\t\tthis.mutate = null;\n\t\tthis.crossover = null;\n\t\tthis.optimize = optimizers.maximize;\n\t\tthis.generation = null;\n\t\tthis.notification = null;\n\t\t// selection functions\n\t\tthis.selectParents = parentsSelectors.tournament3;\n\t\tthis.selectIndividual = individualSelectors.tournament3;\n\t}\n\n\tnewIndividualFromGenome = genome => ({\n\t\tfitness: 0,\n\t\tgenome\n\t});\n\n\tshouldApplyFromRate = rate => Math.random() <= rate;\n\n\tstop() {\n\t\tthis.stopFlag = true;\n\t}\n\n\tasync run(config) {\n\t\tthis.config = { ...defaultConfig, ...config };\n\t\t// seed population\n\t\tfor (let i = 0; i < this.config.population_size; ++i)\n\t\t\tthis.population.push(this.newIndividualFromGenome(this.seed()));\n\n\t\tthis.generation(0, this.population);\n\n\t\t// main loop\n\t\tfor (let gen = 0; gen < this.config.iterations && !this.stopFlag; ++gen) {\n\t\t\tthis.population = this.population.map(async individual => {\n\t\t\t\treturn {\n\t\t\t\t\tfitness: await this.fitness(individual.genome),\n\t\t\t\t\tgenome: individual.genome\n\t\t\t\t};\n\t\t\t});\n\n\t\t\tif (this.preFitnessEval) this.preFitnessEval();\n\t\t\tthis.population = await Promise.all(this.population);\n\t\t\tthis.population.sort((a, b) =>\n\t\t\t\tthis.optimize(a.fitness, b.fitness) ? -1 : 1\n\t\t\t);\n\n\t\t\t// user controlled stop\n\t\t\tthis.generation(gen, this.population);\n\n\t\t\t// evolve population\n\t\t\tlet newPopulation = [];\n\n\t\t\t// if option specified, keep fittest individual\n\t\t\tif (this.config.fittestAlwaysSurvive)\n\t\t\t\tnewPopulation.push(this.population[0]);\n\n\t\t\t// generate next population round\n\t\t\twhile (newPopulation.length < this.config.population_size) {\n\t\t\t\tif (\n\t\t\t\t\tthis.crossover &&\n\t\t\t\t\tthis.shouldApplyFromRate(this.config.crossover_rate) &&\n\t\t\t\t\tnewPopulation.length + 1 < this.config.population_size\n\t\t\t\t) {\n\t\t\t\t\tconst parents = this.selectParents(this.population, this.optimize);\n\t\t\t\t\tconst childrens = this.crossover(parents[0], parents[1]);\n\t\t\t\t\tnewPopulation.concat(\n\t\t\t\t\t\tchildrens.map(children => this.newIndividualFromGenome(children))\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tlet indiv = this.selectIndividual(this.population, this.optimize);\n\t\t\t\t\tif (this.shouldApplyFromRate(this.config.mutation_rate))\n\t\t\t\t\t\tindiv = this.mutate(indiv);\n\t\t\t\t\tnewPopulation.push(this.newIndividualFromGenome(indiv));\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.population = newPopulation;\n\t\t}\n\n\t\t// cleanup\n\t\tthis.population = [];\n\t\tthis.stopFlag = false;\n\t}\n}\n","import { lerp } from \"./math\";\n\nexport const addLeadingZeros = (str, targetLength) => {\n\treturn \"0\".repeat(targetLength - str.length) + str;\n};\n\nexport const decodeFloatsFromBinaryStr = (binStr, floatNb) => {\n\tconst paramBitLength = binStr.length / floatNb;\n\tlet decoded = [];\n\tfor (let i = 0; i < binStr.length; i += paramBitLength)\n\t\tdecoded.push(\n\t\t\tlerp(\n\t\t\t\tparseInt(binStr.substr(i, paramBitLength), 2),\n\t\t\t\t0,\n\t\t\t\tNumber.MAX_SAFE_INTEGER,\n\t\t\t\t0.0,\n\t\t\t\t1.0\n\t\t\t)\n\t\t);\n\treturn decoded;\n};\n","export const lerp = (number, in_min, in_max, out_min, out_max) => {\n\treturn (\n\t\t((number - in_min) * (out_max - out_min)) / (in_max - in_min) + out_min\n\t);\n};\n\nexport const increasePerc = (a, b) => ((a - b) / b) * 100;\n","import { addLeadingZeros } from \"../utils/string\";\n\nconst bitLength = Number.MAX_SAFE_INTEGER.toString(2).length;\n\nexport const seed = () => {\n\tconst PIDParams = [Math.random(), Math.random(), Math.random()];\n\tlet genome = \"\";\n\tPIDParams.forEach(PIDParam => {\n\t\tgenome += addLeadingZeros(\n\t\t\tMath.floor(PIDParam * Number.MAX_SAFE_INTEGER).toString(2),\n\t\t\tbitLength\n\t\t);\n\t});\n\treturn genome;\n};\n\nexport const mutate = entity => {\n\tconst flipIndex = Math.floor(Math.random() * entity.length);\n\tfunction replaceAt(string, index, replace) {\n\t\treturn string.substring(0, index) + replace + string.substring(index + 1);\n\t}\n\treturn replaceAt(entity, flipIndex, entity[flipIndex] === \"1\" ? \"0\" : \"1\");\n};\n\nexport const crossover = (mother, father) => {\n\t// two-point crossover\n\tvar len = mother.length;\n\tvar ca = Math.floor(Math.random() * len);\n\tvar cb = Math.floor(Math.random() * len);\n\tif (ca > cb) {\n\t\tvar tmp = cb;\n\t\tcb = ca;\n\t\tca = tmp;\n\t}\n\n\tvar son =\n\t\tfather.substr(0, ca) + mother.substr(ca, cb - ca) + father.substr(cb);\n\tvar daughter =\n\t\tmother.substr(0, ca) + father.substr(ca, cb - ca) + mother.substr(cb);\n\n\treturn [son, daughter];\n};\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { World, Mouse, MouseConstraint, Render } from \"matter-js\";\n\nconst Canvas = styled.canvas`\n\tz-index: 1;\n\tposition: absolute;\n`;\n\nexport default class SimulatorRenderer extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.canvasRef = React.createRef();\n\t}\n\n\tcomponentDidMount() {\n\t\tlet canvas = this.canvasRef.current;\n\t\tcanvas.width = window.innerWidth;\n\t\tcanvas.height = window.innerHeight;\n\n\t\twindow.addEventListener(\"resize\", () => {\n\t\t\tthis.canvasRef.current.width = window.innerWidth;\n\t\t\tthis.canvasRef.current.height = window.innerHeight;\n\t\t});\n\n\t\tconst render = Render.create({\n\t\t\tcanvas: this.canvasRef.current,\n\t\t\tengine: this.props.engine,\n\t\t\toptions: {\n\t\t\t\twidth: window.innerWidth,\n\t\t\t\theight: window.innerHeight,\n\t\t\t\twireframes: true,\n\t\t\t\tshowAngleIndicator: true,\n\t\t\t\tshowCollisions: true,\n\t\t\t\tshowIds: true,\n\t\t\t\tshowDebug: true\n\t\t\t}\n\t\t});\n\t\t// add mouse control\n\t\tvar mouse = Mouse.create(render.canvas),\n\t\t\tmouseConstraint = MouseConstraint.create(this.props.engine, {\n\t\t\t\tmouse: mouse,\n\t\t\t\tconstraint: {\n\t\t\t\t\tstiffness: 0.2,\n\t\t\t\t\trender: {\n\t\t\t\t\t\tvisible: false\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\tWorld.add(this.props.engine.world, mouseConstraint);\n\t\tRender.run(render);\n\t}\n\n\trender() {\n\t\treturn <Canvas ref={this.canvasRef} />;\n\t}\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\n\nconst LogoWrapper = styled.div`\n\tmargin-bottom: 1.5rem;\n\toverflow: auto;\n`;\n\nconst LogoText = styled.div`\n\tfloat: left;\n\tclear: left;\n\tfont-size: 1.5em;\n\tcolor: black;\n\tbackground-color: white;\n\tpadding: 0.2rem 0.3rem;\n\tmargin-bottom: 0.2rem;\n\tfont-family: \"Source Code Pro\", monospace;\n`;\n\nconst Logo = () => (\n\t<LogoWrapper>\n\t\t<LogoText>genetic</LogoText>\n\t\t<LogoText>playground</LogoText>\n\t</LogoWrapper>\n);\n\nexport default Logo;\n","import styled from \"styled-components\";\n\nconst StatLine = styled.div`\n\tfont-size: 1em;\n\tcolor: white;\n\tfont-family: \"Source Code Pro\", monospace;\n\tmargin-top: 0.5em;\n`;\n\nexport default StatLine;\n","import styled from \"styled-components\";\n\nconst Overlay = styled.div`\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\tleft: 0;\n\tz-index: 2;\n\tmargin: 3rem;\n\tdisplay: flex;\n\tjustify-content: space-between;\n`;\n\nexport default Overlay;\n","import styled from \"styled-components\";\n\nconst SettingsPanel = styled.div``;\n\nexport default SettingsPanel;\n","import React from \"react\";\nimport styled from \"styled-components\";\n\nconst SettingInputLineWrapper = styled.div`\n\tmargin-bottom: 0.5rem;\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-items: center;\n\tjustify-content: stretch;\n`;\n\nconst SettingName = styled.div`\n\tfont-size: 1em;\n\tcolor: white;\n\tfont-family: \"Source Code Pro\", monospace;\n`;\n\nconst SettingInput = styled.input`\n\tmargin-left: 0.5rem;\n\twidth: 4rem;\n\tpadding: 0.2rem 0.5rem;\n\tdisplay: inline-block;\n\tborder: 1px solid #333;\n\tbackground-color: transparent;\n\tfont-size: 1em;\n\tcolor: white;\n\tfont-family: \"Source Code Pro\", monospace;\n\toutline: none;\n\t&:disabled {\n\t\tborder-color: transparent;\n\t}\n`;\n\nconst SettingSelect = styled.select`\n\tmargin-left: 0.5rem;\n\twidth: 8rem;\n\tpadding: 0.2rem 0.5rem;\n\tdisplay: inline-block;\n\tborder: 1px solid #333;\n\t-webkit-appearance: none;\n\t-webkit-border-radius: 0px;\n\tbackground-color: transparent;\n\tfont-size: 1em;\n\tcolor: white;\n\tfont-family: \"Source Code Pro\", monospace;\n\toutline: none;\n\t&:disabled {\n\t\tborder-color: transparent;\n\t}\n`;\n\nconst SettingSelectOption = styled.option``;\n\nconst SettingInputLine = ({\n\ttext,\n\tname,\n\tvalue,\n\toptions,\n\tdisabled,\n\tonChange\n}) => {\n\treturn (\n\t\t<SettingInputLineWrapper>\n\t\t\t<SettingName>{`${text}:`}</SettingName>\n\t\t\t{options === undefined ? (\n\t\t\t\t<SettingInput\n\t\t\t\t\tname={name}\n\t\t\t\t\tonChange={onChange}\n\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\tvalue={value}\n\t\t\t\t/>\n\t\t\t) : (\n\t\t\t\t<SettingSelect\n\t\t\t\t\tname={name}\n\t\t\t\t\tonChange={onChange}\n\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\tvalue={value}\n\t\t\t\t>\n\t\t\t\t\t{options.map(option => (\n\t\t\t\t\t\t<SettingSelectOption key={option} value={option}>\n\t\t\t\t\t\t\t{option}\n\t\t\t\t\t\t</SettingSelectOption>\n\t\t\t\t\t))}\n\t\t\t\t</SettingSelect>\n\t\t\t)}\n\t\t</SettingInputLineWrapper>\n\t);\n};\n\nexport default SettingInputLine;\n","import styled from \"styled-components\";\n\nconst Divider = styled.div`\n\tpadding: 1rem;\n`;\n\nexport default Divider;\n","import styled from \"styled-components\";\n\nconst Button = styled.button`\n\tpadding: 0.5rem 1rem;\n\tborder: 2px solid white;\n\tbackground-color: transparent;\n\tcolor: white;\n\tfont-size: 1rem;\n\tfont-family: \"Source Code Pro\", monospace;\n\tcursor: pointer;\n\toutline: none;\n\t&:hover {\n\t\topacity: 0.8;\n\t}\n`;\n\nexport default Button;\n","import React from \"react\";\nimport styled from \"styled-components\";\n\nconst AuthorWrapper = styled.div`\n\talign-self: flex-end;\n\tfont-size: 0.8rem;\n\tcolor: white;\n\tfont-family: \"Source Code Pro\", monospace;\n`;\n\nconst AuthorLink = styled.a`\n\tcolor: white;\n\ttext-decoration: none;\n\t&:hover {\n\t\tcursor: pointer;\n\t\topacity: 0.8;\n\t}\n`;\n\nconst Author = () => (\n\t<AuthorWrapper>\n\t\tMade with{\" \"}\n\t\t<span role=\"img\" aria-label=\"heart\">\n\t\t\t❤️\n\t\t</span>{\" \"}\n\t\tby{\" \"}\n\t\t<AuthorLink href=\"https://github.com/theochampion\">\n\t\t\tThéo Champion\n\t\t</AuthorLink>\n\t</AuthorWrapper>\n);\n\nexport default Author;\n","import styled from \"styled-components\";\n\nconst VisPanel = styled.div``;\n\nexport default VisPanel;\n","import React from \"react\";\nimport styled from \"styled-components\";\n\nconst GenVisContainer = styled.div`\n\twidth: 300px;\n\tword-wrap: break-word;\n\tmargin-top: 0.5em;\n\tfont-size: 1em;\n\tcolor: white;\n\tfont-family: \"Source Code Pro\", monospace;\n`;\n\nconst GenBitChange = styled.span`\n\tfont-size: 1em;\n\tcolor: #d21f3c;\n\tfont-family: \"Source Code Pro\", monospace;\n`;\n\nconst GenomeVis = ({ exGenome, genome }) => (\n\t<GenVisContainer>\n\t\t{Array.from(genome).map((bit, idx) =>\n\t\t\tbit === exGenome[idx] ? bit : <GenBitChange key={idx}>{bit}</GenBitChange>\n\t\t)}\n\t</GenVisContainer>\n);\n\nexport default GenomeVis;\n","import React from \"react\";\nimport styled from \"styled-components\";\n\nconst NegPerc = styled.span`\n\tfont-size: 1em;\n\tcolor: #d21f3c;\n\tfont-family: \"Source Code Pro\", monospace;\n`;\n\nconst EvolPercVis = ({ perc }) =>\n\tperc >= 0 ? (\n\t\t`+${perc.toFixed(1)}%`\n\t) : (\n\t\t<NegPerc>{`${perc.toFixed(1)}%`}</NegPerc>\n\t);\n\nexport default EvolPercVis;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { XYPlot, LineSeries, XAxis, YAxis } from \"react-vis\";\n\nconst StatPlotContainer = styled.div`\n\tmargin-top: 1rem;\n`;\n\nconst StatPlot = ({ best_fitness_data, avg_fitness_data }) => (\n\t<StatPlotContainer>\n\t\t<XYPlot width={300} height={200}>\n\t\t\t<LineSeries\n\t\t\t\tdata={best_fitness_data.map(p => ({ x: p.generation, y: p.fitness }))}\n\t\t\t\tcolor=\"red\"\n\t\t\t\tcurve={null}\n\t\t\t\topacity={1}\n\t\t\t\tstrokeStyle=\"solid\"\n\t\t\t\tstrokeWidth=\"1px\"\n\t\t\t/>\n\t\t\t<LineSeries\n\t\t\t\tdata={avg_fitness_data.map(p => ({ x: p.generation, y: p.fitness }))}\n\t\t\t\tcolor=\"red\"\n\t\t\t\tcurve={null}\n\t\t\t\topacity={0.9}\n\t\t\t\tstrokeStyle=\"dashed\"\n\t\t\t\tstrokeWidth=\"1px\"\n\t\t\t/>\n\t\t\t<XAxis\n\t\t\t\ttitle=\"generation\"\n\t\t\t\tstyle={{\n\t\t\t\t\tline: { stroke: \"#fff\" },\n\t\t\t\t\tticks: { stroke: \"#fff\" },\n\t\t\t\t\ttext: { stroke: \"none\", fill: \"#fff\", fontWeight: 600 },\n\t\t\t\t\ttitle: { stroke: \"none\", fill: \"#fff\", fontWeight: 600 }\n\t\t\t\t}}\n\t\t\t/>\n\t\t\t<YAxis\n\t\t\t\ttitle=\"fitness\"\n\t\t\t\tstyle={{\n\t\t\t\t\tline: { stroke: \"#fff\" },\n\t\t\t\t\tticks: { stroke: \"#fff\" },\n\t\t\t\t\ttext: { stroke: \"none\", fill: \"#fff\", fontWeight: 600 },\n\t\t\t\t\ttitle: { stroke: \"none\", fill: \"#fff\", fontWeight: 600 }\n\t\t\t\t}}\n\t\t\t/>\n\t\t</XYPlot>\n\t</StatPlotContainer>\n);\n\nexport default StatPlot;\n","import { increasePerc } from \"./math\";\n\nexport const getLastItem = arr => arr[arr.length - 1];\n\nexport const getFitnessStatPercIncrease = arr => {\n\tif (arr.length <= 2) return 0.0;\n\treturn increasePerc(arr[arr.length - 1].fitness, arr[arr.length - 2].fitness);\n};\n\nexport const statsToCSVFile = (best, avg) => {\n\tconst legend = `generation,best_fitness,average_fitness`;\n\tlet csv = \"\";\n\tbest.forEach(\n\t\t(d, idx) => (csv += `${d.generation},${d.fitness},${avg[idx].fitness}\\n`)\n\t);\n\n\tconsole.log(csv);\n\treturn encodeURI(`data:text/csv;charset=utf-8,${legend}\\n${csv}`);\n};\n","import React, { Component } from \"react\";\nimport seedrandom from \"seedrandom\";\n// simulator\nimport SimulatorEngine from \"./simulator/simulator_engine\";\n// genetic\nimport Genetic, { optimizers } from \"./genetic/genetic\";\nimport { individualSelectors, parentsSelectors } from \"./genetic/selectors\";\nimport { seed, mutate, crossover } from \"./genetic/genetic_config\";\n// components\nimport SimulatorRenderer from \"./simulator/simulator_renderer\";\nimport Logo from \"./components/logo\";\nimport StatLine from \"./components/stat_line\";\nimport Overlay from \"./components/overlay\";\nimport SettingsPanel from \"./components/settings_panel\";\nimport SettingInputLine from \"./components/setting_input\";\nimport Divider from \"./components/divider\";\nimport Button from \"./components/button\";\nimport Author from \"./components/author\";\nimport VisPanel from \"./components/vis_panel\";\nimport GenomeVis from \"./components/genome_vis\";\nimport EvolPercVis from \"./components/evol_perc_vis\";\nimport StatPlot from \"./components/stat_plot\";\n// utils\nimport { decodeFloatsFromBinaryStr } from \"./utils/string\";\nimport {\n\tgetLastItem,\n\tgetFitnessStatPercIncrease,\n\tstatsToCSVFile\n} from \"./utils/misc\";\n\nconst settings = [\n\t{ text: \"Population Size\", name: \"population_size\" },\n\t{ text: \"Mutation rate\", name: \"mutation_rate\" },\n\t{ text: \"Crossover rate\", name: \"crossover_rate\" },\n\t{ text: \"Random seed\", name: \"random_seed\" }\n];\n\nconst default_seed = \"h8cnkRWfbI\";\n\nexport default class App extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\t// settings\n\t\t\tindiv_selector: \"tournament3\",\n\t\t\tparent_selector: \"tournament3\",\n\t\t\tpopulation_size: 10,\n\t\t\tmutation_rate: 0.5,\n\t\t\tcrossover_rate: 0.5,\n\t\t\trandom_seed: default_seed,\n\t\t\t// simulation\n\t\t\tsimulationRunning: false,\n\t\t\tgeneration: 0,\n\t\t\tex_fittest_genome: \"\",\n\t\t\tfittest_genome: \"\",\n\t\t\tfittest_params: [],\n\t\t\tbest_fitness_stat: [],\n\t\t\tavg_fitness_stat: []\n\t\t};\n\t\tthis.geneticEngine = new Genetic();\n\t\tthis.simulatorEngine = new SimulatorEngine();\n\n\t\tthis.geneticEngine.seed = seed;\n\t\tthis.geneticEngine.mutate = mutate;\n\t\tthis.geneticEngine.crossover = crossover;\n\t\tthis.geneticEngine.optimize = optimizers.maximize;\n\t\tthis.geneticEngine.selectIndividual =\n\t\t\tindividualSelectors[this.state.indiv_selector];\n\t\tthis.geneticEngine.selectParents =\n\t\t\tparentsSelectors[this.state.parent_selector];\n\t\tthis.geneticEngine.generation = (generation, population) => {\n\t\t\tthis.setState(pv => ({\n\t\t\t\tgeneration: generation + 1,\n\t\t\t\tex_fittest_genome:\n\t\t\t\t\tgeneration === 0 ? population[0].genome : pv.fittest_genome,\n\t\t\t\tfittest_genome: population[0].genome,\n\t\t\t\tfittest_params: decodeFloatsFromBinaryStr(population[0].genome, 3),\n\t\t\t\tbest_fitness_stat: [\n\t\t\t\t\t...pv.best_fitness_stat,\n\t\t\t\t\t{ generation: generation, fitness: population[0].fitness }\n\t\t\t\t],\n\t\t\t\tavg_fitness_stat: [\n\t\t\t\t\t...pv.avg_fitness_stat,\n\t\t\t\t\t{\n\t\t\t\t\t\tgeneration: generation,\n\t\t\t\t\t\tfitness:\n\t\t\t\t\t\t\tpopulation\n\t\t\t\t\t\t\t\t.map(indiv => indiv.fitness)\n\t\t\t\t\t\t\t\t.reduce((a, b) => a + b, 0) / population.length\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}));\n\t\t};\n\n\t\tthis.geneticEngine.preFitnessEval = () => {\n\t\t\tthis.simulatorEngine.run();\n\t\t};\n\n\t\tthis.geneticEngine.fitness = async entity => {\n\t\t\tconst pidParams = decodeFloatsFromBinaryStr(entity, 3);\n\t\t\treturn await this.simulatorEngine.addVehicle(\n\t\t\t\tpidParams[0],\n\t\t\t\tpidParams[1],\n\t\t\t\tpidParams[2]\n\t\t\t);\n\t\t};\n\t}\n\n\t_runSimulation = () => {\n\t\tseedrandom(this.state.random_seed, { global: true });\n\t\tthis.geneticEngine.run({\n\t\t\titerations: 5000,\n\t\t\tpopulation_size: parseFloat(this.state.population_size),\n\t\t\tmutation_rate: parseFloat(this.state.mutation_rate),\n\t\t\tcrossover_rate: parseFloat(this.state.crossover_rate)\n\t\t});\n\t\tthis.setState({ simulationRunning: true });\n\t};\n\n\t_stopSimulation = () => {\n\t\tthis.geneticEngine.stop();\n\t\tthis.simulatorEngine.stop();\n\t\tthis.setState({ simulationRunning: false });\n\t};\n\n\t_handleSettingChange = e =>\n\t\tthis.setState({ [e.target.name]: e.target.value });\n\n\t_downloadStatsAsCSV = () => {\n\t\tconst encodedCSV = statsToCSVFile(\n\t\t\tthis.state.best_fitness_stat,\n\t\t\tthis.state.avg_fitness_stat\n\t\t);\n\t\tconst exportName = `GP_export_${this.state.indiv_selector}_${\n\t\t\tthis.state.parent_selector\n\t\t}_${this.state.population_size}_${this.state.mutation_rate}_${\n\t\t\tthis.state.crossover_rate\n\t\t}_${this.state.random_seed}_${Date.now()}.csv`;\n\n\t\tconst link = document.createElement(\"a\");\n\t\tlink.setAttribute(\"href\", encodedCSV);\n\t\tlink.setAttribute(\"download\", exportName);\n\t\tdocument.body.appendChild(link);\n\t\tlink.click();\n\t\tdocument.body.removeChild(link);\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<Overlay>\n\t\t\t\t\t<SettingsPanel>\n\t\t\t\t\t\t<Logo />\n\t\t\t\t\t\t<Author />\n\t\t\t\t\t\t<Divider />\n\t\t\t\t\t\t<SettingInputLine\n\t\t\t\t\t\t\ttext=\"Indiv selector\"\n\t\t\t\t\t\t\tname=\"indiv_selector\"\n\t\t\t\t\t\t\tvalue={this.state.indiv_selector}\n\t\t\t\t\t\t\toptions={Object.keys(individualSelectors)}\n\t\t\t\t\t\t\tdisabled={this.state.simulationRunning}\n\t\t\t\t\t\t\tonChange={e => {\n\t\t\t\t\t\t\t\tthis.geneticEngine.selectIndividual =\n\t\t\t\t\t\t\t\t\tindividualSelectors[e.target.value];\n\t\t\t\t\t\t\t\tthis._handleSettingChange(e);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<SettingInputLine\n\t\t\t\t\t\t\ttext=\"Parent selector\"\n\t\t\t\t\t\t\tname=\"parent_selector\"\n\t\t\t\t\t\t\tvalue={this.state.parent_selector}\n\t\t\t\t\t\t\toptions={Object.keys(parentsSelectors)}\n\t\t\t\t\t\t\tdisabled={this.state.simulationRunning}\n\t\t\t\t\t\t\tonChange={e => {\n\t\t\t\t\t\t\t\tthis.geneticEngine.selectParents =\n\t\t\t\t\t\t\t\t\tparentsSelectors[e.target.value];\n\t\t\t\t\t\t\t\tthis._handleSettingChange(e);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Divider />\n\t\t\t\t\t\t{settings.map(({ text, name }) => (\n\t\t\t\t\t\t\t<SettingInputLine\n\t\t\t\t\t\t\t\tkey={name}\n\t\t\t\t\t\t\t\ttext={text}\n\t\t\t\t\t\t\t\tname={name}\n\t\t\t\t\t\t\t\tvalue={this.state[name]}\n\t\t\t\t\t\t\t\tdisabled={this.state.simulationRunning}\n\t\t\t\t\t\t\t\tonChange={this._handleSettingChange}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t\t<Divider />\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tonClick={\n\t\t\t\t\t\t\t\tthis.state.simulationRunning\n\t\t\t\t\t\t\t\t\t? this._stopSimulation\n\t\t\t\t\t\t\t\t\t: this._runSimulation\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{this.state.simulationRunning ? \"Stop\" : \"Run\"}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</SettingsPanel>\n\t\t\t\t\t{this.state.simulationRunning && (\n\t\t\t\t\t\t<VisPanel>\n\t\t\t\t\t\t\t<StatLine>{`Generation: ${this.state.generation}`}</StatLine>\n\t\t\t\t\t\t\t<StatLine>\n\t\t\t\t\t\t\t\t{`Average fitness: ${\n\t\t\t\t\t\t\t\t\tgetLastItem(this.state.avg_fitness_stat).fitness\n\t\t\t\t\t\t\t\t} (`}\n\t\t\t\t\t\t\t\t<EvolPercVis\n\t\t\t\t\t\t\t\t\tperc={getFitnessStatPercIncrease(this.state.avg_fitness_stat)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t</StatLine>\n\t\t\t\t\t\t\t<StatLine>\n\t\t\t\t\t\t\t\t{`Best fitness: ${\n\t\t\t\t\t\t\t\t\tgetLastItem(this.state.best_fitness_stat).fitness\n\t\t\t\t\t\t\t\t} (`}\n\t\t\t\t\t\t\t\t<EvolPercVis\n\t\t\t\t\t\t\t\t\tperc={getFitnessStatPercIncrease(\n\t\t\t\t\t\t\t\t\t\tthis.state.best_fitness_stat\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t</StatLine>\n\t\t\t\t\t\t\t<StatPlot\n\t\t\t\t\t\t\t\tbest_fitness_data={this.state.best_fitness_stat}\n\t\t\t\t\t\t\t\tavg_fitness_data={this.state.avg_fitness_stat}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<StatLine>{`Fittest individual genome:`}</StatLine>\n\t\t\t\t\t\t\t<GenomeVis\n\t\t\t\t\t\t\t\texGenome={this.state.ex_fittest_genome}\n\t\t\t\t\t\t\t\tgenome={this.state.fittest_genome}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<StatLine>{`Fittest individual params:`}</StatLine>\n\t\t\t\t\t\t\t<StatLine>{`P:${this.state.fittest_params[0].toFixed(\n\t\t\t\t\t\t\t\t3\n\t\t\t\t\t\t\t)} I:${this.state.fittest_params[1].toFixed(\n\t\t\t\t\t\t\t\t3\n\t\t\t\t\t\t\t)} D:${this.state.fittest_params[2].toFixed(3)}`}</StatLine>\n\t\t\t\t\t\t\t<Button onClick={this._downloadStatsAsCSV}>Download CSV</Button>\n\t\t\t\t\t\t</VisPanel>\n\t\t\t\t\t)}\n\t\t\t\t</Overlay>\n\n\t\t\t\t<SimulatorRenderer engine={this.simulatorEngine.engine} />\n\t\t\t</>\n\t\t);\n\t}\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport \"../node_modules/react-vis/dist/style.css\";\n\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}